<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Introduction · Geant4.jl</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>Geant4.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Introduction</a><ul class="internal"><li><a class="tocitem" href="#Building-the-wrapper-code"><span>Building the wrapper code</span></a></li><li><a class="tocitem" href="#Getting-started"><span>Getting started</span></a></li><li><a class="tocitem" href="#Running-the-tests"><span>Running the tests</span></a></li><li><a class="tocitem" href="#Running-the-examples"><span>Running the examples</span></a></li><li><a class="tocitem" href="#Running-the-visualization-examples"><span>Running the visualization examples</span></a></li></ul></li><li><a class="tocitem" href="api/">APIs</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="notebooks/TestEm3/">Example TestEm3</a></li><li><a class="tocitem" href="notebooks/B1/">Example B1</a></li><li><a class="tocitem" href="notebooks/B2a/">Example B2a</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Introduction</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Introduction</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaHEP/Geant4.jl/blob/master/docs/src/index.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Geant4.jl"><a class="docs-heading-anchor" href="#Geant4.jl">Geant4.jl</a><a id="Geant4.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Geant4.jl" title="Permalink"></a></h1><p><a href="https://github.com/JuliaHEP/Geant4.jl/actions"><img src="https://github.com/JuliaHEP/Geant4.jl/workflows/CI/badge.svg" alt="Build Status"/></a> <a href="https://codecov.io/gh/JuliaHEP/Geant4.jl"><img src="https://codecov.io/gh/JuliaHEP/Geant4.jl/branch/master/graph/badge.svg" alt="Codecov"/></a></p><p>Julia bindings for the <a href="https://geant4.web.cern.ch">Geant4</a> particle transportation toolkit. It is using <a href="https://github.com/JuliaInterop/CxxWrap.jl">CxxWrap.jl</a> package to wrap C++ types and functions to Julia. Since the Geant4 toolkit is rather large and complex, writing the wrapper code by hand is not really an option. For this we use the package <a href="https://github.com/grasph/wrapit">WrapIt</a> that automates the generation of the wrapper code making use of the clang library.</p><h2 id="Building-the-wrapper-code"><a class="docs-heading-anchor" href="#Building-the-wrapper-code">Building the wrapper code</a><a id="Building-the-wrapper-code-1"></a><a class="docs-heading-anchor-permalink" href="#Building-the-wrapper-code" title="Permalink"></a></h2><p>We use the Geant4 libraries and data from the binary package <a href="https://github.com/JuliaBinaryWrappers/Geant4_jll.jl">Geant4_jll</a>, which has been produced with the <code>BinaryBuilder</code> <a href="https://github.com/JuliaPackaging/Yggdrasil/tree/master/G/Geant4">recipe</a>. The wrapper library is downloaded from the binary package <a href="https://github.com/JuliaBinaryWrappers/Geant4_julia_jll.jl">Geant4<em>julia</em>jll</a>.    </p><p>In order to re-generate locally new C++ wrapper code we need to have <code>wrapit</code> installed, which itself requires <code>libclang</code> to be installed. If the executable is not found (not in the PATH), we can use the wrapper code that is already pre-generated and distributed with this package.</p><ul><li>what C++ classes get wrapped is controlled by the file <code>gen/Geant4.wit</code>. See the documentation of WrapIt for the details. </li><li>run the <code>gen/build.jl</code> script generate the wrapper code (if wrapit found) and build the wrapper library.</li></ul><p>Once the wrapper code is stabilized we can move the generated code to the repository <a href="https://github.com/peremato/Geant4_cxxwrap">Geant4_cxxwrap</a> to regenerate the binary package <code>Geant using the</code>BinaryBuilder`.</p><h2 id="Getting-started"><a class="docs-heading-anchor" href="#Getting-started">Getting started</a><a id="Getting-started-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-started" title="Permalink"></a></h2><p>Import the <code>Geant4</code> module. All the wrapped Geant4 classes are exported since they are prefixed by <code>G4</code> minimizing the chances of a name clash with other Julia symbols. </p><pre><code class="language-julia hljs">
julia&gt; using Geant4
julia&gt; runManager = G4RunManager()
**************************************************************
 Geant4 version Name: geant4-11-01-patch-01 [MT]   (10-February-2023)
                       Copyright : Geant4 Collaboration
                      References : NIM A 506 (2003), 250-303
                                 : IEEE-TNS 53 (2006), 270-278
                                 : NIM A 835 (2016), 186-225
                             WWW : http://geant4.org/
**************************************************************

Geant4.G4RunManagerAllocated(Ptr{Nothing} @0x00007f9fcb6f9c50)

julia&gt; methodswith(G4RunManager, supertypes=true)
[1] convert(t::Type{G4RunManager}, x::T) where T&lt;:G4RunManager in Geant4 at /Users/mato/.julia/packages/CxxWrap/IdOJa/src/CxxWrap.jl:676
[2] AbortEvent(arg1::Union{CxxWrap.CxxWrapCore.CxxRef{&lt;:G4RunManager}, Union{CxxWrap.CxxWrapCore.SmartPointer{T2}, T2} where T2&lt;:G4RunManager}) in Geant4 at /Users/mato/.julia/packages/CxxWrap/IdOJa/src/CxxWrap.jl:618
...
[94] rndmSaveThisRun(arg1::Union{CxxWrap.CxxWrapCore.CxxRef{&lt;:G4RunManager}, Union{CxxWrap.CxxWrapCore.SmartPointer{T2}, T2} where T2&lt;:G4RunManager}) in Geant4 at /Users/mato/.julia/packages/CxxWrap/IdOJa/src/CxxWrap.jl:618

julia&gt; v = GetVersionString(runManager)
ConstCxxRef{G4String}(Ptr{G4String} @0x00007ffed34df2d8)

julia&gt; String(v)
&quot; Geant4 version Name: geant4-11-01-patch-01 [MT]   (10-February-2023)&quot;</code></pre><p>Note that class methods are called with the object instance as first argument. In C++ the <code>GetVersionString</code> method would be called as <code>runManager-&gt;GetVersionString()</code> while in Julia it is called as <code>GetVersionString(runManager)</code>. Thanks to the Julia multi-dispatch we do not need to prefix the methods with the module name <code>Geant4.GetVersionString(runManager)</code>, even for very common function names such as <code>mag</code>.</p><pre><code class="language-julia hljs">julia&gt; v = G4ThreeVector(1,2,3)
Geant4.CLHEP!Hep3VectorAllocated(Ptr{Nothing} @0x00007f9fcaf2a710)

julia&gt; mag(v)
3.7416573867739413</code></pre><h2 id="Running-the-tests"><a class="docs-heading-anchor" href="#Running-the-tests">Running the tests</a><a id="Running-the-tests-1"></a><a class="docs-heading-anchor-permalink" href="#Running-the-tests" title="Permalink"></a></h2><p>To run the tests execute <code>julia --project . test/runtests.jl</code></p><h2 id="Running-the-examples"><a class="docs-heading-anchor" href="#Running-the-examples">Running the examples</a><a id="Running-the-examples-1"></a><a class="docs-heading-anchor-permalink" href="#Running-the-examples" title="Permalink"></a></h2><p>For the time being there are only three examples: </p><h3 id="basic/B1"><a class="docs-heading-anchor" href="#basic/B1">basic/B1</a><a id="basic/B1-1"></a><a class="docs-heading-anchor-permalink" href="#basic/B1" title="Permalink"></a></h3><p>To run it execute <code>julia --project=. examples/basic/B1/B1.j</code> or execute the notebook <code>B1.ipynb</code></p><h3 id="basic/B2a"><a class="docs-heading-anchor" href="#basic/B2a">basic/B2a</a><a id="basic/B2a-1"></a><a class="docs-heading-anchor-permalink" href="#basic/B2a" title="Permalink"></a></h3><p>To run it execute <code>julia --project=. examples/basic/B2/B2a.jl</code></p><h3 id="TestEm3"><a class="docs-heading-anchor" href="#TestEm3">TestEm3</a><a id="TestEm3-1"></a><a class="docs-heading-anchor-permalink" href="#TestEm3" title="Permalink"></a></h3><p>This example comes from <em>extended/electromagnetic/TestEm3</em> example. Since it requires addional packages such as FHist and Plots it has its own Julia environment in the folder <code>examples/TestEm3</code>. To run it execute <code>julia --project=examples/TestEm3 -i examples/TestEm3/TestEm3.jl</code> </p><h2 id="Running-the-visualization-examples"><a class="docs-heading-anchor" href="#Running-the-visualization-examples">Running the visualization examples</a><a id="Running-the-visualization-examples-1"></a><a class="docs-heading-anchor-permalink" href="#Running-the-visualization-examples" title="Permalink"></a></h2><p>The project includes additional functionality for visualization under the directory G4Visualization. This is done in a different directory to separate the dependencies. To run the examples do:</p><ul><li><code>julia --project=G4Visualization -i  G4Visualization/examples/B1vis.jl</code>Note the option <code>-i</code> to keep the interactive session open.</li></ul></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="api/">APIs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Thursday 13 April 2023 18:41">Thursday 13 April 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
